function checkGeolocationPermission() {
    if (navigator.permissions) {
        navigator.permissions.query({ name: 'geolocation' })
            .then(function (result) {
                if (result.state === 'granted') {
                    console.log("Geolocation permission granted.");
                    getDistance(); // 권한이 부여된 경우 위치 정보를 요청합니다.
                } else if (result.state === 'prompt') {
                    console.log("Geolocation permission not granted. User needs to grant access.");
                    requestGeolocationPermission(); // 권한 요청을 진행합니다.
                } else {
                    alert("위치 조회를 위한 권한이 거부되어 있는 상태입니다. 브라우저 설정에서 위치 권한을 허용해 주세요.");
                    console.log("Geolocation permission denied.");
                }
            })
            .catch(function (error) {
                console.log("Error checking geolocation permission: ", error);
            });
    } else {
        console.log("Permissions API is not supported by this browser.");
        getDistance(); // Permissions API가 지원되지 않는 경우에도 위치 정보를 요청할 수 있습니다.
    }
}

function requestGeolocationPermission() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            function(position) {
                console.log("Geolocation permission granted.");
                getDistance(); // 위치 정보를 요청합니다.
            },
            function(error) {
                alert("서비스를 이용하기 위해서는 권한 허용이 필요합니다.");
                console.log("Error requesting geolocation permission: ", error);
            }
        );
    } else {
        console.log("Geolocation is not supported by this browser.");
    }
}
